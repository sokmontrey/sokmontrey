---
layout: "@/layouts/ArticleLayout.astro"
title: "Computational Graph & Automatic Differentiation"
description: "Representing mathematical expression in a computer program is straight-forward, but implementing functions and taking its derivative is a different story."
type: "article"
tags: ["article", "mathematics", "programming", "machine learning", "graph theory"]
date: "January 23, 2024"
---

import Collapsible from '@/components/article/Collapsible.svelte';

import AbstractFunction from './AbstractFunction.svelte';
import FamiliarFunction from './FamiliarFunction.svelte';
import AverageNotInstant from './AverageNotInstant.svelte';

{/*
VERSION 2: 
-> NOTE: this article assume you know what a mathematical function is.
-> If not, here is a quick overview
-> But why? optimization, derivative, gradient, etc.
-> Can't we just write the function and the derivative?
-> Machine learning application.
-> Beside from the optimization with tensor inputs, we want to find the gradient automatically.
*/}

> <span class='pm-color font-mono'>Note:</span><br />
> This article assumes that you have a basic understanding of functions (both in math and programming) and derivatives. Below is a quick overview.

<Collapsible client:load is_collapsed={false}>
<h1 slot="toggler">Overview</h1>

## Function
A function tells us how things turn into another. The things that get in/out of a function can be anything, including a function itself.

<AbstractFunction client:load />

This is a very abstract definition of a function. A more familiar form is the one that takes in a number and gives out, potentially, a different number.

<br />

$$
f(x) = x^2
$$

<FamiliarFunction client:load />

## Derivative
The concept of derivative is beautiful. I wrote another article purely dedicated to this which you can read [here](/articles/derivative) (probably doesn't exist yet).

<br />

All you need to know for this article is that:

<br />

1. You want to know how a function $f(x)$ is changing at a specific input $a$.
2. To determine if or how something is changing, we need at least two data points to see the difference.

$$
\frac{f(b) - f(a)}{b - a} 
$$
$$
\textrm{(divided by the change in input b - a to find the rate)}
$$

3. But two is not one. We want to know the rate of change of the function at $a$ not an overall average, from $a$ to $b$.

<AverageNotInstant client:load />

4. With derivative, we simply ask: "what if those two points are very close together?" Not on top of one another, but very close.

$$
\lim_{b\to a} \frac{f(b) - f(a)}{b - a}
$$

With $\lim$ we can make $b$ approach $a$. $b$ is not equal to $a$, but it's very close. This is the derivative of $f(x)$ at $a$. 

<br />

Now, we can find the derivative of $f(x)$ at any point $x$. To do so we increase $x$ by a small amount $h$ then divide the difference of output and input together.

<div class="p-2 my-4 border border-[var(--pm-color)] rounded-lg ">

$$
\color{white} {\lim_{h\to0} \frac{\color{lightgreen} {f(x + h)} \color{lightblue} { -f(x)}}{h}}
$$

</div>

This is the **fundamental definition of derivative**. But we, a sane individual, would love to have a little abstraction. There are derivative rules on **elementary functions** (power, exponential, trig function, etc) that can solve any complex function as long as applied with **combinational derivative rules** (product, chain rule, etc).

</Collapsible>

# Why?
